<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–º–Ω—ã–µ –∫—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            max-width: 800px;
            width: 100%;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            margin: 20px 0;
            color: #00b4d8;
            font-size: 2.5rem;
            text-shadow: 0 0 10px rgba(0, 180, 216, 0.5);
        }

        .game-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
            padding: 20px;
        }

        .settings {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 20px;
            padding: 25px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .settings h2 {
            margin-bottom: 20px;
            color: #00b4d8;
            font-size: 1.8rem;
        }

        .settings-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .setting {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 15px;
            border-left: 4px solid #00b4d8;
        }

        .setting h3 {
            margin-bottom: 12px;
            font-size: 1.2rem;
            color: #90e0ef;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .option {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .option:hover {
            background: rgba(0, 180, 216, 0.2);
            transform: translateY(-2px);
        }

        .option.selected {
            background: #00b4d8;
            color: white;
            border-color: #90e0ef;
            box-shadow: 0 0 15px rgba(0, 180, 216, 0.5);
        }

        .option.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .toggle-switch {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 10px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #00b4d8;
        }

        input:checked + .slider:before {
            transform: translateX(30px);
        }

        .game-board {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 25px;
        }

        .board {
            display: grid;
            gap: 5px;
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            border-radius: 15px;
            border: 2px solid rgba(0, 180, 216, 0.3);
            max-width: 500px;
            width: 100%;
            aspect-ratio: 1/1;
        }

        .cell {
            background: rgba(255, 255, 255, 0.07);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            user-select: none;
        }

        .cell:hover {
            background: rgba(0, 180, 216, 0.15);
            border-color: rgba(0, 180, 216, 0.5);
            transform: scale(1.05);
        }

        .cell.x {
            color: #ff6b6b;
            text-shadow: 0 0 20px rgba(255, 107, 107, 0.7);
            font-size: 4.5rem;
        }

        .cell.o {
            color: #4dffea;
            text-shadow: 0 0 20px rgba(77, 255, 234, 0.7);
            font-size: 4.5rem;
        }

        .cell.hint {
            animation: hint-pulse 2s infinite;
        }

        @keyframes hint-pulse {
            0%, 100% { 
                background: rgba(0, 255, 136, 0.15);
                box-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
            }
            50% { 
                background: rgba(0, 255, 136, 0.25);
                box-shadow: 0 0 20px rgba(0, 255, 136, 0.7);
            }
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        button {
            padding: 14px 32px;
            background: linear-gradient(135deg, #00b4d8 0%, #0077b6 100%);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            min-width: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            background: linear-gradient(135deg, #0096c7 0%, #005f8a 100%);
        }

        button:active {
            transform: translateY(-1px);
        }

        button.secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            min-width: 140px;
        }

        button.secondary:hover {
            background: linear-gradient(135deg, #5a6268 0%, #343a40 100%);
        }

        .status {
            text-align: center;
            font-size: 1.4rem;
            min-height: 40px;
            padding: 10px;
            color: #90e0ef;
            font-weight: 600;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            width: 100%;
            max-width: 500px;
        }

        .winning-cell {
            animation: pulse 1s infinite;
            background: rgba(0, 255, 136, 0.15);
            border-color: #00ff88;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.5);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .hint-info {
            text-align: center;
            color: #80ffdb;
            font-size: 1rem;
            margin-top: -15px;
            min-height: 24px;
            background: rgba(0, 255, 136, 0.1);
            padding: 5px 10px;
            border-radius: 5px;
            max-width: 500px;
            width: 100%;
        }

        .setting-info {
            font-size: 0.85rem;
            color: #a0a0a0;
            margin-top: 8px;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .game-container {
                padding: 10px;
            }
            
            .settings-group {
                grid-template-columns: 1fr;
            }
            
            .cell {
                font-size: 3rem;
            }
            
            .cell.x, .cell.o {
                font-size: 3.5rem;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                width: 100%;
                max-width: 300px;
            }
        }

        @media (max-width: 480px) {
            .settings {
                padding: 15px;
            }
            
            .cell {
                font-size: 2.5rem;
            }
            
            .cell.x, .cell.o {
                font-size: 3rem;
            }
            
            .option {
                padding: 6px 12px;
                font-size: 0.9rem;
            }
            
            button {
                padding: 12px 24px;
                font-size: 1rem;
                min-width: auto;
            }
            
            .status {
                font-size: 1.2rem;
            }
        }

        @media (max-width: 360px) {
            .cell {
                font-size: 2rem;
            }
            
            .cell.x, .cell.o {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚öîÔ∏è –£–º–Ω—ã–µ –∫—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ ‚öîÔ∏è</h1>
        
        <div class="game-container">
            <div class="settings">
                <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã</h2>
                <div class="settings-group">
                    <div class="setting">
                        <h3>üìê –†–∞–∑–º–µ—Ä –ø–æ–ª—è</h3>
                        <div class="options" id="sizeOptions">
                            <div class="option selected" data-size="3">3√ó3</div>
                            <div class="option" data-size="4">4√ó4</div>
                            <div class="option" data-size="5">5√ó5</div>
                        </div>
                    </div>
                    
                    <div class="setting">
                        <h3>üéØ –£—Å–ª–æ–≤–∏–µ –ø–æ–±–µ–¥—ã</h3>
                        <div class="options" id="winOptions">
                            <div class="option selected" data-win="3">3 –≤ —Ä—è–¥</div>
                            <div class="option" data-win="4">4 –≤ —Ä—è–¥</div>
                            <div class="option" data-win="5">5 –≤ —Ä—è–¥</div>
                        </div>
                    </div>
                    
                    <div class="setting">
                        <h3>ü§ñ –°–ª–æ–∂–Ω–æ—Å—Ç—å –±–æ—Ç–∞</h3>
                        <div class="options" id="difficultyOptions">
                            <div class="option selected" data-difficulty="easy">–õ–µ–≥–∫–∏–π</div>
                            <div class="option" data-difficulty="medium">–°—Ä–µ–¥–Ω–∏–π</div>
                            <div class="option" data-difficulty="hard">–°–ª–æ–∂–Ω—ã–π</div>
                        </div>
                    </div>
                    
                    <div class="setting">
                        <h3>üë§ –ü–µ—Ä–≤—ã–π —Ö–æ–¥</h3>
                        <div class="options" id="firstMoveOptions">
                            <div class="option selected" data-first="X">–ö—Ä–µ—Å—Ç–∏–∫ (–í—ã)</div>
                            <div class="option" data-first="O">–ù–æ–ª–∏–∫ (–ë–æ—Ç)</div>
                        </div>
                    </div>
                    
                    <div class="setting">
                        <h3>‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ö–æ–¥–∞</h3>
                        <div class="toggle-switch">
                            <span>–í–∫–ª—é—á–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é</span>
                            <label class="switch">
                                <input type="checkbox" id="optimizationToggle" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="setting-info">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç—Å—è –¥–ª—è –ø–æ–ª–µ–π 5√ó5</div>
                    </div>
                    
                    <div class="setting">
                        <h3>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∏</h3>
                        <div class="toggle-switch">
                            <span>–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª—É—á—à–∏–π —Ö–æ–¥</span>
                            <label class="switch">
                                <input type="checkbox" id="hintToggle" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="hint-info" id="hintInfo"></div>
                    </div>
                </div>
            </div>
            
            <div class="game-board">
                <div class="status" id="status">–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –Ω–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É"</div>
                
                <div class="board" id="board"></div>
                
                <div class="controls">
                    <button id="startBtn">üéÆ –ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                    <button id="hintBtn" class="secondary">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
                    <button id="resetBtn" class="secondary">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        class TicTacToeBot {
            constructor() {
                this.boardSize = 3;
                this.winLength = 3;
                this.difficulty = 'hard';
                this.firstMove = 'X';
                this.currentPlayer = 'X';
                this.board = [];
                this.gameActive = false;
                this.winningCells = [];
                this.hintsEnabled = true;
                this.optimizationEnabled = true;
                this.currentHint = null;
                this.hintTimeout = null;
                
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.createBoard();
                this.updateOptimizationToggle();
            }
            
            setupEventListeners() {
                // –í—ã–±–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–ª—è
                document.querySelectorAll('#sizeOptions .option').forEach(option => {
                    option.addEventListener('click', () => {
                        document.querySelectorAll('#sizeOptions .option').forEach(opt => opt.classList.remove('selected'));
                        option.classList.add('selected');
                        this.boardSize = parseInt(option.dataset.size);
                        this.updateWinOptions();
                        this.updateOptimizationToggle();
                        this.clearHint();
                    });
                });
                
                // –í—ã–±–æ—Ä —É—Å–ª–æ–≤–∏—è –ø–æ–±–µ–¥—ã
                document.querySelectorAll('#winOptions .option').forEach(option => {
                    option.addEventListener('click', () => {
                        if (option.classList.contains('disabled')) return;
                        document.querySelectorAll('#winOptions .option').forEach(opt => opt.classList.remove('selected'));
                        option.classList.add('selected');
                        this.winLength = parseInt(option.dataset.win);
                        this.clearHint();
                    });
                });
                
                // –í—ã–±–æ—Ä —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
                document.querySelectorAll('#difficultyOptions .option').forEach(option => {
                    option.addEventListener('click', () => {
                        document.querySelectorAll('#difficultyOptions .option').forEach(opt => opt.classList.remove('selected'));
                        option.classList.add('selected');
                        this.difficulty = option.dataset.difficulty;
                        this.clearHint();
                    });
                });
                
                // –í—ã–±–æ—Ä –ø–µ—Ä–≤–æ–≥–æ —Ö–æ–¥–∞
                document.querySelectorAll('#firstMoveOptions .option').forEach(option => {
                    option.addEventListener('click', () => {
                        document.querySelectorAll('#firstMoveOptions .option').forEach(opt => opt.classList.remove('selected'));
                        option.classList.add('selected');
                        this.firstMove = option.dataset.first;
                        this.clearHint();
                    });
                });
                
                // –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
                document.getElementById('optimizationToggle').addEventListener('change', (e) => {
                    this.optimizationEnabled = e.target.checked;
                });
                
                // –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –ø–æ–¥—Å–∫–∞–∑–æ–∫
                document.getElementById('hintToggle').addEventListener('change', (e) => {
                    this.hintsEnabled = e.target.checked;
                    if (!this.hintsEnabled) {
                        this.clearHint();
                    } else if (this.gameActive && this.currentPlayer === 'X') {
                        this.showHint();
                    }
                });
                
                // –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                document.getElementById('startBtn').addEventListener('click', () => this.startGame());
                document.getElementById('hintBtn').addEventListener('click', () => this.showHint());
                document.getElementById('resetBtn').addEventListener('click', () => this.resetGame());
            }
            
            updateWinOptions() {
                const winOptions = document.querySelectorAll('#winOptions .option');
                winOptions.forEach(option => {
                    const winValue = parseInt(option.dataset.win);
                    if (winValue > this.boardSize) {
                        option.classList.add('disabled');
                    } else {
                        option.classList.remove('disabled');
                    }
                });
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±—Ä–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
                const availableOptions = Array.from(winOptions)
                    .filter(opt => !opt.classList.contains('disabled'))
                    .map(opt => parseInt(opt.dataset.win));
                
                if (availableOptions.length > 0) {
                    const maxWin = Math.max(...availableOptions);
                    this.winLength = maxWin;
                    
                    winOptions.forEach(option => {
                        option.classList.remove('selected');
                        if (parseInt(option.dataset.win) === maxWin) {
                            option.classList.add('selected');
                        }
                    });
                }
            }
            
            updateOptimizationToggle() {
                const optimizationToggle = document.getElementById('optimizationToggle');
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞—Ç—å –¥–ª—è –ø–æ–ª—è 5√ó5
                if (this.boardSize === 5) {
                    optimizationToggle.checked = true;
                    this.optimizationEnabled = true;
                }
            }
            
            createBoard() {
                const boardElement = document.getElementById('board');
                boardElement.style.gridTemplateColumns = `repeat(${this.boardSize}, 1fr)`;
                boardElement.innerHTML = '';
                
                // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–ª—è
                let fontSize = 4.5; // –î–ª—è 3√ó3
                if (this.boardSize === 4) fontSize = 3.5;
                if (this.boardSize === 5) fontSize = 2.8;
                
                for (let i = 0; i < this.boardSize * this.boardSize; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.index = i;
                    cell.style.fontSize = `${fontSize}rem`;
                    cell.addEventListener('click', () => this.makeMove(i));
                    boardElement.appendChild(cell);
                }
            }
            
            startGame() {
                this.board = Array(this.boardSize * this.boardSize).fill('');
                this.currentPlayer = this.firstMove;
                this.gameActive = true;
                this.winningCells = [];
                this.currentHint = null;
                this.createBoard();
                
                document.getElementById('status').textContent = 
                    this.currentPlayer === 'X' ? '–í–∞—à —Ö–æ–¥ (–ö—Ä–µ—Å—Ç–∏–∫)' : '–•–æ–¥ –±–æ—Ç–∞ (–ù–æ–ª–∏–∫)...';
                
                if (this.currentPlayer === 'O') {
                    setTimeout(() => this.botMove(), 500);
                } else if (this.hintsEnabled) {
                    setTimeout(() => this.showHint(), 300);
                }
            }
            
            resetGame() {
                this.gameActive = false;
                this.winningCells = [];
                this.currentHint = null;
                document.getElementById('status').textContent = '–ò–≥—Ä–∞ —Å–±—Ä–æ—à–µ–Ω–∞. –ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É"';
                document.getElementById('hintInfo').textContent = '';
                this.createBoard();
            }
            
            makeMove(index) {
                if (!this.gameActive || this.board[index] !== '') return;
                if (this.currentPlayer !== 'X') return;
                
                this.clearHint();
                this.board[index] = 'X';
                this.updateBoard();
                
                if (this.checkWin('X')) {
                    this.gameActive = false;
                    document.getElementById('status').textContent = 'üéâ –í—ã –ø–æ–±–µ–¥–∏–ª–∏!';
                    this.highlightWinningCells();
                    return;
                }
                
                if (this.isBoardFull()) {
                    this.gameActive = false;
                    document.getElementById('status').textContent = 'ü§ù –ù–∏—á—å—è!';
                    return;
                }
                
                this.currentPlayer = 'O';
                document.getElementById('status').textContent = '–•–æ–¥ –±–æ—Ç–∞...';
                
                setTimeout(() => this.botMove(), 500);
            }
            
            botMove() {
                if (!this.gameActive || this.currentPlayer !== 'O') return;
                
                let move;
                
                switch(this.difficulty) {
                    case 'easy':
                        move = this.getEasyMove();
                        break;
                    case 'medium':
                        move = this.getMediumMove();
                        break;
                    case 'hard':
                        move = this.getHardMove();
                        break;
                    default:
                        move = this.getHardMove();
                }
                
                if (move !== -1 && this.board[move] === '') {
                    this.board[move] = 'O';
                    this.updateBoard();
                    
                    if (this.checkWin('O')) {
                        this.gameActive = false;
                        document.getElementById('status').textContent = 'ü§ñ –ë–æ—Ç –ø–æ–±–µ–¥–∏–ª!';
                        this.highlightWinningCells();
                        return;
                    }
                    
                    if (this.isBoardFull()) {
                        this.gameActive = false;
                        document.getElementById('status').textContent = 'ü§ù –ù–∏—á—å—è!';
                        return;
                    }
                    
                    this.currentPlayer = 'X';
                    document.getElementById('status').textContent = '–í–∞—à —Ö–æ–¥ (–ö—Ä–µ—Å—Ç–∏–∫)';
                    
                    if (this.hintsEnabled) {
                        setTimeout(() => this.showHint(), 300);
                    }
                }
            }
            
            getEasyMove() {
                // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ —Ö–æ–¥—ã
                for (let i = 0; i < this.board.length; i++) {
                    if (this.board[i] === '') {
                        this.board[i] = 'O';
                        if (this.checkWin('O')) {
                            this.board[i] = '';
                            return i;
                        }
                        this.board[i] = '';
                    }
                }
                
                // –°–ª—É—á–∞–π–Ω—ã–π —Ö–æ–¥
                const availableMoves = this.board
                    .map((cell, index) => cell === '' ? index : -1)
                    .filter(index => index !== -1);
                
                return availableMoves.length > 0 
                    ? availableMoves[Math.floor(Math.random() * availableMoves.length)] 
                    : -1;
            }
            
            getMediumMove() {
                // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ —Ö–æ–¥—ã
                for (let i = 0; i < this.board.length; i++) {
                    if (this.board[i] === '') {
                        this.board[i] = 'O';
                        if (this.checkWin('O')) {
                            this.board[i] = '';
                            return i;
                        }
                        this.board[i] = '';
                    }
                }
                
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ —Ö–æ–¥—ã –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞
                for (let i = 0; i < this.board.length; i++) {
                    if (this.board[i] === '') {
                        this.board[i] = 'X';
                        if (this.checkWin('X')) {
                            this.board[i] = '';
                            return i;
                        }
                        this.board[i] = '';
                    }
                }
                
                // –°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–µ –ø–æ–∑–∏—Ü–∏–∏
                const center = Math.floor(this.board.length / 2);
                if (this.board[center] === '') return center;
                
                // –≠–≤—Ä–∏—Å—Ç–∏–∫–∞: –æ—Ü–µ–Ω–∫–∞ –ø–æ–∑–∏—Ü–∏–π
                let bestScore = -Infinity;
                let bestMove = -1;
                
                for (let i = 0; i < this.board.length; i++) {
                    if (this.board[i] === '') {
                        let score = this.evaluatePosition(i, 'O');
                        if (score > bestScore) {
                            bestScore = score;
                            bestMove = i;
                        }
                    }
                }
                
                return bestMove;
            }
            
            getHardMove() {
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é
                const useOptimization = this.optimizationEnabled && (this.boardSize >= 5);
                
                if (useOptimization) {
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø–æ–ª–µ–π
                    return this.getOptimizedMove();
                } else {
                    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –≥–ª—É–±–∏–Ω–æ–π
                    return this.getFullMove();
                }
            }
            
            getFullMove() {
                // –î–ª—è –ø–æ–ª–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–∏–Ω–∏–º–∞–∫—Å —Å —Ä–∞–∑–Ω–æ–π –≥–ª—É–±–∏–Ω–æ–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–ª—è
                let depth;
                if (this.boardSize === 3) depth = 9; // –ü–æ–ª–Ω—ã–π –ø–µ—Ä–µ–±–æ—Ä –¥–ª—è 3√ó3
                else if (this.boardSize === 4) depth = 4; // –ì–ª—É–±–∏–Ω–∞ 4 –¥–ª—è 4√ó4
                else depth = 3; // –ì–ª—É–±–∏–Ω–∞ 3 –¥–ª—è 5√ó5 –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
                
                return this.minimax(this.board, 0, true, -Infinity, Infinity, depth).index;
            }
            
            getOptimizedMove() {
                // –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø–æ–ª–µ–π
                // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ —Ö–æ–¥—ã
                for (let i = 0; i < this.board.length; i++) {
                    if (this.board[i] === '') {
                        this.board[i] = 'O';
                        if (this.checkWin('O')) {
                            this.board[i] = '';
                            return i;
                        }
                        this.board[i] = '';
                    }
                }
                
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ —Ö–æ–¥—ã –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞
                for (let i = 0; i < this.board.length; i++) {
                    if (this.board[i] === '') {
                        this.board[i] = 'X';
                        if (this.checkWin('X')) {
                            this.board[i] = '';
                            return i;
                        }
                        this.board[i] = '';
                    }
                }
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–∏–Ω–∏–º–∞–∫—Å —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –≥–ª—É–±–∏–Ω–æ–π –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–º –ø–æ–∏—Å–∫–æ–º
                return this.minimaxOptimized(this.board, 0, true, -Infinity, Infinity, 3).index;
            }
            
            minimax(board, depth, isMaximizing, alpha, beta, maxDepth) {
                if (this.checkWin('O')) return { score: 1000 - depth };
                if (this.checkWin('X')) return { score: -1000 + depth };
                if (this.isBoardFull() || depth >= maxDepth) return { score: this.evaluateBoard() };
                
                let bestScore = isMaximizing ? -Infinity : Infinity;
                let bestMove = -1;
                
                // –ü–æ–ª—É—á–∞–µ–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —Ö–æ–¥—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
                const moves = this.getPriorityMoves(board);
                
                for (let i of moves) {
                    if (board[i] === '') {
                        board[i] = isMaximizing ? 'O' : 'X';
                        let score = this.minimax(board, depth + 1, !isMaximizing, alpha, beta, maxDepth).score;
                        board[i] = '';
                        
                        if (isMaximizing) {
                            if (score > bestScore) {
                                bestScore = score;
                                bestMove = i;
                            }
                            alpha = Math.max(alpha, bestScore);
                        } else {
                            if (score < bestScore) {
                                bestScore = score;
                                bestMove = i;
                            }
                            beta = Math.min(beta, bestScore);
                        }
                        
                        if (beta <= alpha) break;
                    }
                }
                
                return { score: bestScore, index: bestMove };
            }
            
            minimaxOptimized(board, depth, isMaximizing, alpha, beta, maxDepth) {
                if (this.checkWin('O')) return { score: 1000 - depth };
                if (this.checkWin('X')) return { score: -1000 + depth };
                if (this.isBoardFull() || depth >= maxDepth) return { score: this.evaluateBoardFast() };
                
                let bestScore = isMaximizing ? -Infinity : Infinity;
                let bestMove = -1;
                
                // –ë—ã—Å—Ç—Ä–∞—è –æ—Ü–µ–Ω–∫–∞ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ö–æ–¥–æ–≤
                const moves = this.getOptimizedMoves(board, isMaximizing ? 'O' : 'X');
                
                for (let i of moves) {
                    if (board[i] === '') {
                        board[i] = isMaximizing ? 'O' : 'X';
                        let score = this.minimaxOptimized(board, depth + 1, !isMaximizing, alpha, beta, maxDepth).score;
                        board[i] = '';
                        
                        if (isMaximizing) {
                            if (score > bestScore) {
                                bestScore = score;
                                bestMove = i;
                            }
                            alpha = Math.max(alpha, bestScore);
                        } else {
                            if (score < bestScore) {
                                bestScore = score;
                                bestMove = i;
                            }
                            beta = Math.min(beta, bestScore);
                        }
                        
                        if (beta <= alpha) break;
                    }
                }
                
                return { score: bestScore, index: bestMove };
            }
            
            getOptimizedMoves(board, player) {
                const moves = [];
                const scores = [];
                
                // –û—Ü–µ–Ω–∏–≤–∞–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ö–æ–¥—ã
                for (let i = 0; i < board.length; i++) {
                    if (board[i] === '') {
                        // –ë—ã—Å—Ç—Ä–∞—è –æ—Ü–µ–Ω–∫–∞ —Ö–æ–¥–∞
                        let score = this.evaluateMoveFast(i, player);
                        moves.push(i);
                        scores.push(score);
                    }
                }
                
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ö–æ–¥—ã –ø–æ —É–±—ã–≤–∞–Ω–∏—é –æ—Ü–µ–Ω–∫–∏
                moves.sort((a, b) => {
                    const scoreA = scores[moves.indexOf(a)];
                    const scoreB = scores[moves.indexOf(b)];
                    return scoreB - scoreA;
                });
                
                return moves;
            }
            
            evaluateMoveFast(index, player) {
                let score = 0;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
                this.board[index] = player;
                if (this.checkWin(player)) score += 1000;
                this.board[index] = '';
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É
                this.board[index] = player === 'O' ? 'X' : 'O';
                if (this.checkWin(player === 'O' ? 'X' : 'O')) score += 500;
                this.board[index] = '';
                
                // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
                const center = Math.floor(this.board.length / 2);
                if (index === center) score += 50;
                
                // –£–≥–ª–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏
                const corners = [0, this.boardSize - 1, 
                               this.boardSize * (this.boardSize - 1), 
                               this.board.length - 1];
                if (corners.includes(index)) score += 30;
                
                // –ë–ª–∏–∑–æ—Å—Ç—å –∫ –¥—Ä—É–≥–∏–º —Å–≤–æ–∏–º —Å–∏–º–≤–æ–ª–∞–º
                const adjacent = this.getAdjacentCells(index);
                for (let adj of adjacent) {
                    if (this.board[adj] === player) score += 20;
                }
                
                return score;
            }
            
            getAdjacentCells(index) {
                const row = Math.floor(index / this.boardSize);
                const col = index % this.boardSize;
                const cells = [];
                
                for (let r = Math.max(0, row - 1); r <= Math.min(this.boardSize - 1, row + 1); r++) {
                    for (let c = Math.max(0, col - 1); c <= Math.min(this.boardSize - 1, col + 1); c++) {
                        if (r !== row || c !== col) {
                            cells.push(r * this.boardSize + c);
                        }
                    }
                }
                
                return cells;
            }
            
            getPriorityMoves(board) {
                const moves = [];
                const center = Math.floor(board.length / 2);
                const corners = [0, this.boardSize - 1, 
                               this.boardSize * (this.boardSize - 1), 
                               board.length - 1];
                
                // –¶–µ–Ω—Ç—Ä
                if (board[center] === '') moves.push(center);
                
                // –£–≥–ª—ã
                for (let corner of corners) {
                    if (board[corner] === '' && !moves.includes(corner)) moves.push(corner);
                }
                
                // –û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–ª–µ—Ç–∫–∏
                for (let i = 0; i < board.length; i++) {
                    if (board[i] === '' && !moves.includes(i)) moves.push(i);
                }
                
                return moves;
            }
            
            evaluatePosition(index, player) {
                let score = 0;
                const lines = this.getLinesThroughCell(index);
                
                for (let line of lines) {
                    let playerCount = 0;
                    let opponentCount = 0;
                    let emptyCount = 0;
                    
                    for (let cellIndex of line) {
                        if (this.board[cellIndex] === player) playerCount++;
                        else if (this.board[cellIndex] === (player === 'X' ? 'O' : 'X')) opponentCount++;
                        else emptyCount++;
                    }
                    
                    if (playerCount === this.winLength - 1 && emptyCount === 1) score += 100;
                    else if (opponentCount === this.winLength - 1 && emptyCount === 1) score += 50;
                    else if (playerCount > 0 && opponentCount === 0) score += playerCount * 10;
                    else if (opponentCount > 0 && playerCount === 0) score += opponentCount * 5;
                }
                
                // –ë–æ–Ω—É—Å –∑–∞ —Ü–µ–Ω—Ç—Ä
                const center = Math.floor(this.board.length / 2);
                if (index === center) score += 20;
                
                // –ë–æ–Ω—É—Å –∑–∞ —É–≥–ª—ã
                const corners = [0, this.boardSize - 1, 
                               this.boardSize * (this.boardSize - 1), 
                               this.board.length - 1];
                if (corners.includes(index)) score += 10;
                
                return score;
            }
            
            evaluateBoard() {
                let score = 0;
                const lines = this.getAllLines();
                
                for (let line of lines) {
                    let playerCount = 0;
                    let opponentCount = 0;
                    let emptyCount = 0;
                    
                    for (let index of line) {
                        if (this.board[index] === 'O') playerCount++;
                        else if (this.board[index] === 'X') opponentCount++;
                        else emptyCount++;
                    }
                    
                    if (playerCount === this.winLength) return 1000;
                    if (opponentCount === this.winLength) return -1000;
                    
                    if (playerCount > 0 && opponentCount === 0) {
                        score += Math.pow(10, playerCount);
                    } else if (opponentCount > 0 && playerCount === 0) {
                        score -= Math.pow(10, opponentCount);
                    }
                }
                
                return score;
            }
            
            evaluateBoardFast() {
                // –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –±—ã—Å—Ç—Ä–∞—è –æ—Ü–µ–Ω–∫–∞ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
                let score = 0;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –æ–ø–∞—Å–Ω—ã–µ –ª–∏–Ω–∏–∏
                const dangerousLines = this.getDangerousLines();
                
                for (let line of dangerousLines) {
                    let playerCount = 0;
                    let opponentCount = 0;
                    
                    for (let index of line) {
                        if (this.board[index] === 'O') playerCount++;
                        else if (this.board[index] === 'X') opponentCount++;
                    }
                    
                    if (playerCount > 0 && opponentCount === 0) {
                        score += playerCount * 5;
                    } else if (opponentCount > 0 && playerCount === 0) {
                        score -= opponentCount * 5;
                    }
                }
                
                return score;
            }
            
            getDangerousLines() {
                // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ª–∏–Ω–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –±–ª–∏–∑–∫–∏ –∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é
                const allLines = this.getAllLines();
                const dangerousLines = [];
                
                for (let line of allLines) {
                    let playerCount = 0;
                    let opponentCount = 0;
                    let emptyCount = 0;
                    
                    for (let index of line) {
                        if (this.board[index] === 'O') playerCount++;
                        else if (this.board[index] === 'X') opponentCount++;
                        else emptyCount++;
                    }
                    
                    // –õ–∏–Ω–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ–ø–∞—Å–Ω–æ–π, –µ—Å–ª–∏ –≤ –Ω–µ–π –Ω–µ –º–µ–Ω–µ–µ winLength-1 —Å–∏–º–≤–æ–ª–æ–≤ –æ–¥–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞
                    if (playerCount >= this.winLength - 1 || opponentCount >= this.winLength - 1) {
                        dangerousLines.push(line);
                    }
                }
                
                return dangerousLines;
            }
            
            showHint() {
                if (!this.gameActive || this.currentPlayer !== 'X' || !this.hintsEnabled) return;
                
                this.clearHint();
                
                // –í—ã—á–∏—Å–ª—è–µ–º –ª—É—á—à–∏–π —Ö–æ–¥ –¥–ª—è –∏–≥—Ä–æ–∫–∞
                let hintIndex;
                
                switch(this.difficulty) {
                    case 'easy':
                        hintIndex = this.getSimpleHint();
                        break;
                    case 'medium':
                    case 'hard':
                        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–æ–∫
                        hintIndex = this.getHintMove();
                        break;
                    default:
                        hintIndex = -1;
                }
                
                if (hintIndex !== -1 && this.board[hintIndex] === '') {
                    this.currentHint = hintIndex;
                    
                    const cells = document.querySelectorAll('.cell');
                    cells[hintIndex].classList.add('hint');
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–¥—Å–∫–∞–∑–∫–µ
                    let reason = "–°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∞—è –ø–æ–∑–∏—Ü–∏—è";
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ—á–µ–º—É —ç—Ç–æ —Ö–æ—Ä–æ—à–∏–π —Ö–æ–¥
                    this.board[hintIndex] = 'X';
                    if (this.checkWin('X')) {
                        reason = "–í—ã–∏–≥—Ä—ã—à–Ω—ã–π —Ö–æ–¥!";
                    } else {
                        this.board[hintIndex] = 'O';
                        if (this.checkWin('O')) {
                            reason = "–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—ã–∏–≥—Ä—ã—à–∞ –±–æ—Ç–∞";
                        }
                    }
                    this.board[hintIndex] = '';
                    
                    document.getElementById('hintInfo').textContent = `–õ—É—á—à–∏–π —Ö–æ–¥: ${reason}`;
                    
                    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
                    this.hintTimeout = setTimeout(() => this.clearHint(), 5000);
                }
            }
            
            getHintMove() {
                // –ë—ã—Å—Ç—Ä—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–æ–∫
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ —Ö–æ–¥—ã
                for (let i = 0; i < this.board.length; i++) {
                    if (this.board[i] === '') {
                        this.board[i] = 'X';
                        if (this.checkWin('X')) {
                            this.board[i] = '';
                            return i;
                        }
                        this.board[i] = '';
                    }
                }
                
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—ã–∏–≥—Ä—ã—à –±–æ—Ç–∞
                for (let i = 0; i < this.board.length; i++) {
                    if (this.board[i] === '') {
                        this.board[i] = 'O';
                        if (this.checkWin('O')) {
                            this.board[i] = '';
                            return i;
                        }
                        this.board[i] = '';
                    }
                }
                
                // –≠–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞
                let bestScore = -Infinity;
                let bestMove = -1;
                
                for (let i = 0; i < this.board.length; i++) {
                    if (this.board[i] === '') {
                        let score = this.evaluateHintPosition(i);
                        if (score > bestScore) {
                            bestScore = score;
                            bestMove = i;
                        }
                    }
                }
                
                return bestMove;
            }
            
            evaluateHintPosition(index) {
                let score = 0;
                
                // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
                const center = Math.floor(this.board.length / 2);
                if (index === center) score += 100;
                
                // –£–≥–ª–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏
                const corners = [0, this.boardSize - 1, 
                               this.boardSize * (this.boardSize - 1), 
                               this.board.length - 1];
                if (corners.includes(index)) score += 50;
                
                // –ë–ª–∏–∑–æ—Å—Ç—å –∫ —Å–≤–æ–∏–º —Å–∏–º–≤–æ–ª–∞–º
                const adjacent = this.getAdjacentCells(index);
                for (let adj of adjacent) {
                    if (this.board[adj] === 'X') score += 20;
                }
                
                return score;
            }
            
            getSimpleHint() {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ —Ö–æ–¥—ã
                for (let i = 0; i < this.board.length; i++) {
                    if (this.board[i] === '') {
                        this.board[i] = 'X';
                        if (this.checkWin('X')) {
                            this.board[i] = '';
                            return i;
                        }
                        this.board[i] = '';
                    }
                }
                
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—ã–∏–≥—Ä—ã—à –±–æ—Ç–∞
                for (let i = 0; i < this.board.length; i++) {
                    if (this.board[i] === '') {
                        this.board[i] = 'O';
                        if (this.checkWin('O')) {
                            this.board[i] = '';
                            return i;
                        }
                        this.board[i] = '';
                    }
                }
                
                // –¶–µ–Ω—Ç—Ä –∏–ª–∏ —É–≥–ª—ã
                const center = Math.floor(this.board.length / 2);
                if (this.board[center] === '') return center;
                
                const corners = [0, this.boardSize - 1, 
                               this.boardSize * (this.boardSize - 1), 
                               this.board.length - 1];
                for (let corner of corners) {
                    if (this.board[corner] === '') return corner;
                }
                
                // –õ—é–±–∞—è —Å–≤–æ–±–æ–¥–Ω–∞—è –∫–ª–µ—Ç–∫–∞
                for (let i = 0; i < this.board.length; i++) {
                    if (this.board[i] === '') return i;
                }
                
                return -1;
            }
            
            clearHint() {
                if (this.hintTimeout) {
                    clearTimeout(this.hintTimeout);
                    this.hintTimeout = null;
                }
                
                if (this.currentHint !== null) {
                    const cells = document.querySelectorAll('.cell');
                    cells[this.currentHint]?.classList.remove('hint');
                    this.currentHint = null;
                    document.getElementById('hintInfo').textContent = '';
                }
            }
            
            getLinesThroughCell(index) {
                const lines = [];
                const row = Math.floor(index / this.boardSize);
                const col = index % this.boardSize;
                
                // –í—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ª–∏–Ω–∏–∏ —á–µ—Ä–µ–∑ –∫–ª–µ—Ç–∫—É
                const allLines = this.getAllLines();
                for (let line of allLines) {
                    if (line.includes(index)) {
                        lines.push(line);
                    }
                }
                
                return lines;
            }
            
            getAllLines() {
                const lines = [];
                
                // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
                for (let row = 0; row < this.boardSize; row++) {
                    for (let col = 0; col <= this.boardSize - this.winLength; col++) {
                        const line = [];
                        for (let k = 0; k < this.winLength; k++) {
                            line.push(row * this.boardSize + col + k);
                        }
                        lines.push(line);
                    }
                }
                
                // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
                for (let col = 0; col < this.boardSize; col++) {
                    for (let row = 0; row <= this.boardSize - this.winLength; row++) {
                        const line = [];
                        for (let k = 0; k < this.winLength; k++) {
                            line.push((row + k) * this.boardSize + col);
                        }
                        lines.push(line);
                    }
                }
                
                // –î–∏–∞–≥–æ–Ω–∞–ª–∏ (—Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ)
                for (let row = 0; row <= this.boardSize - this.winLength; row++) {
                    for (let col = 0; col <= this.boardSize - this.winLength; col++) {
                        const line = [];
                        for (let k = 0; k < this.winLength; k++) {
                            line.push((row + k) * this.boardSize + (col + k));
                        }
                        lines.push(line);
                    }
                }
                
                // –î–∏–∞–≥–æ–Ω–∞–ª–∏ (—Å–ø—Ä–∞–≤–∞ –Ω–∞–ª–µ–≤–æ)
                for (let row = 0; row <= this.boardSize - this.winLength; row++) {
                    for (let col = this.winLength - 1; col < this.boardSize; col++) {
                        const line = [];
                        for (let k = 0; k < this.winLength; k++) {
                            line.push((row + k) * this.boardSize + (col - k));
                        }
                        lines.push(line);
                    }
                }
                
                return lines;
            }
            
            checkWin(player) {
                const lines = this.getAllLines();
                
                for (let line of lines) {
                    if (line.every(index => this.board[index] === player)) {
                        this.winningCells = line;
                        return true;
                    }
                }
                
                return false;
            }
            
            isBoardFull() {
                return this.board.every(cell => cell !== '');
            }
            
            updateBoard() {
                const cells = document.querySelectorAll('.cell');
                cells.forEach((cell, index) => {
                    cell.textContent = this.board[index];
                    cell.className = 'cell';
                    if (this.board[index] === 'X') {
                        cell.classList.add('x');
                        cell.style.fontSize = this.boardSize === 3 ? '4.5rem' : 
                                             this.boardSize === 4 ? '3.5rem' : '2.8rem';
                    }
                    if (this.board[index] === 'O') {
                        cell.classList.add('o');
                        cell.style.fontSize = this.boardSize === 3 ? '4.5rem' : 
                                             this.boardSize === 4 ? '3.5rem' : '2.8rem';
                    }
                    if (this.winningCells.includes(index)) {
                        cell.classList.add('winning-cell');
                    }
                });
            }
            
            highlightWinningCells() {
                this.winningCells.forEach(index => {
                    const cell = document.querySelector(`.cell[data-index="${index}"]`);
                    if (cell) {
                        cell.classList.add('winning-cell');
                    }
                });
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', () => {
            new TicTacToeBot();
        });
    </script>
</body>
                            </html>
